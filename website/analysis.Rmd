---
title: "Analysis"
knit: (function(input_file, encoding) {
  out_dir <- '../docs';
  rmarkdown::render(input_file,
 encoding=encoding,
 output_file=file.path(dirname(input_file), out_dir, 'analysis.html'))})
output:
  html_document:
    toc: true
    toc_float: true
    theme: darkly
---

This analysis has two areas of focus: the United States, and Oregon counties. 

```{r, include=FALSE}
here::i_am("website/analysis.Rmd")
```

```{r load data, include=FALSE}
# library
library(reactable)
library(magrittr)
# list data 
us_list <- readRDS(here::here("clean_data",
                              "us_list.rds"))
or_list <- readRDS(here::here("clean_data",
                              "or_list.rds"))
# variables
todays_date <- readRDS(here::here("clean_data",
                                  "date_today.rds"))
datas_date <- readRDS(here::here("clean_data",
                                 "date_data.rds"))
# current data 
us_current <- readRDS(here::here("clean_data",
                               paste0("us_", datas_date, ".rds")))
or_current <- readRDS(here::here("clean_data",
                               paste0("or_", datas_date, ".rds")))
```

# United States

```{r, echo=FALSE}
# nightmode theme 
options(reactable.theme = reactableTheme(
  color = "hsl(233, 9%, 87%)",
  backgroundColor = "hsl(233, 9%, 19%)",
  borderColor = "hsl(233, 9%, 22%)",
  stripedColor = "hsl(233, 12%, 22%)",
  highlightColor = "hsl(233, 12%, 24%)",
  inputStyle = list(backgroundColor = "hsl(233, 9%, 25%)"),
  selectStyle = list(backgroundColor = "hsl(233, 9%, 25%)"),
  pageButtonHoverStyle = list(backgroundColor = "hsl(233, 9%, 25%)"),
  pageButtonActiveStyle = list(backgroundColor = "hsl(233, 9%, 28%)")
))
reactable::reactable(us_current %>% 
            # remove date column
            dplyr::select(!Date),
          # modify columns 
          columns = list(Population = colDef(format = colFormat(separators = TRUE)),
                         Cases = colDef(format = colFormat(separators = TRUE)),
                         cases_per_pop = colDef(name = "Percent of Cases", 
                                                format = colFormat(percent = TRUE,
                                                                   digits = 2)),
                         Deaths = colDef(format = colFormat(separators = TRUE)),
                         deaths_per_pop = colDef(name = "Percent of Deaths",
                                                 format = colFormat(percent = TRUE,
                                                                    digits = 2)),
                         full_vacc = colDef(name = "Fully Vaccinated",
                                            format = colFormat(separators = TRUE)),
                         full_vacc_per_pop = colDef(name = "Percent Fully Vaccinated",
                                                    format = colFormat(percent = TRUE,
                                                                       digits = 2)),
                         partial_vacc = colDef(name = "Partially Vaccinated",
                                               format = colFormat(separators = TRUE)),
                         partial_vacc_per_pop = colDef(name = "Percent Partially Vaccinated",
                                                       format = colFormat(percent = TRUE, digits = 2))),
                     defaultSorted = list(Cases = "desc"),
                     bordered = TRUE,
                     highlight = TRUE,
                     showPageSizeOptions = TRUE,
                     pageSizeOptions = c(5, 10, 20, 50),
                     defaultPageSize = 5)
```

## Populated Places

#### What states have the **most** covid cases? What states have the **most** covid related deaths? What states have the **most** people fully and partially vaccinated?

The state with the most reported covid cases since `r datas_date` is `r us_list[[1]][1,1]` (<span style="color: turquoise ;">`r us_list[[1]][1,2]`</span>), followed by `r us_list[[1]][2,1]` (<span style="color: turquoise ;">`r us_list[[1]][2,2]`</span>), `r us_list[[1]][3,1]` (<span style="color: turquoise ;">`r us_list[[1]][3,2]`</span>), `r us_list[[1]][4,1]` (<span style="color: turquoise ;">`r us_list[[1]][4,2]`</span>), and then `r us_list[[1]][5,1]` (<span style="color: turquoise ;">`r us_list[[1]][5,2]`</span>).

The state with the most reported covid related deaths since `r datas_date` is `r us_list[[3]][1,1]` (<span style="color: turquoise ;">`r us_list[[3]][1,2]`</span>), followed by `r us_list[[3]][2,1]` (<span style="color: turquoise ;">`r us_list[[3]][2,2]`</span>), `r us_list[[3]][3,1]` (<span style="color: turquoise ;">`r us_list[[3]][3,2]`</span>), `r us_list[[3]][4,1]` (<span style="color: turquoise ;">`r us_list[[3]][4,2]`</span>), and then `r us_list[[3]][5,1]` (<span style="color: turquoise ;">`r us_list[[3]][5,2]`</span>). 

The state with the most people fully vaccinated since `r datas_date` is `r us_list[[5]][1,1]` (<span style="color: turquoise ;">`r us_list[[5]][1,2]`</span>), followed by `r us_list[[5]][2,1]` (<span style="color: turquoise ;">`r us_list[[5]][2,2]`</span>), `r us_list[[5]][3,1]` (<span style="color: turquoise ;">`r us_list[[5]][3,2]`</span>), `r us_list[[5]][4,1]` (<span style="color: turquoise ;">`r us_list[[5]][4,2]`</span>), and then `r us_list[[5]][5,1]` (<span style="color: turquoise ;">`r us_list[[5]][5,2]`</span>). 

The state with the most people partially vaccinated since `r datas_date` is `r us_list[[7]][1,1]` (<span style="color: turquoise ;">`r us_list[[7]][1,2]`</span>), followed by `r us_list[[7]][2,1]` (<span style="color: turquoise ;">`r us_list[[7]][2,2]`</span>), `r us_list[[7]][3,1]` (<span style="color: turquoise ;">`r us_list[[7]][3,2]`</span>), `r us_list[[7]][4,1]` (<span style="color: turquoise ;">`r us_list[[7]][4,2]`</span>), and then `r us_list[[7]][5,1]` (<span style="color: turquoise ;">`r us_list[[7]][5,2]`</span>). 

## Contageous Spaces

#### What states have the **highest percent** of cases? What states have the **highest percent** of covid related deaths? What states have the **highest percent** of people fully and partially vaccinated? 

As of `r datas_date` `r us_list[[2]][1,1]`  has the highest percent of cases per population with <span style="color: turquoise ;">`r us_list[[2]][1,2]`</span>. Then `r us_list[[2]][2,1]` (<span style="color: turquoise ;">`r us_list[[2]][2,2]`</span>), `r us_list[[2]][3,1]` (<span style="color: turquoise ;">`r us_list[[2]][3,2]`</span>), `r us_list[[2]][4,1]` (<span style="color: turquoise ;">`r us_list[[2]][4,2]`</span>), and `r us_list[[2]][5,1]` (<span style="color: turquoise ;">`r us_list[[2]][5,2]`</span>). 

As of `r datas_date` `r us_list[[4]][1,1]` has the highest percent of covid related deaths per population with <span style="color: turquoise ;">`r us_list[[4]][1,2]`</span>. Then `r us_list[[4]][2,1]` (<span style="color: turquoise ;">`r us_list[[4]][2,2]`</span>), `r us_list[[4]][3,1]` (<span style="color: turquoise ;">`r us_list[[4]][3,2]`</span>), `r us_list[[4]][4,1]` (<span style="color: turquoise ;">`r us_list[[4]][4,2]`</span>), and `r us_list[[4]][5,1]` (<span style="color: turquoise ;">`r us_list[[4]][5,2]`</span>). 

The state with the highest percent of people fully vaccinated since `r datas_date` is `r us_list[[6]][1,1]` (<span style="color: turquoise ;">`r us_list[[6]][1,2]`</span>), followed by `r us_list[[6]][2,1]` (<span style="color: turquoise ;">`r us_list[[6]][2,2]`</span>), `r us_list[[6]][3,1]` (<span style="color: turquoise ;">`r us_list[[6]][3,2]`</span>), `r us_list[[6]][4,1]` (<span style="color: turquoise ;">`r us_list[[6]][4,2]`</span>), and then `r us_list[[6]][5,1]` (<span style="color: turquoise ;">`r us_list[[6]][5,2]`</span>). 

The state with the highest percent of people partially vaccinated since `r datas_date` is `r us_list[[8]][1,1]` (<span style="color: turquoise ;">`r us_list[[8]][1,2]`</span>), followed by `r us_list[[8]][2,1]` (<span style="color: turquoise ;">`r us_list[[8]][2,2]`</span>), `r us_list[[8]][3,1]` (<span style="color: turquoise ;">`r us_list[[8]][3,2]`</span>), `r us_list[[8]][4,1]` (<span style="color: turquoise ;">`r us_list[[8]][4,2]`</span>), and then `r us_list[[8]][5,1]` (<span style="color: turquoise ;">`r us_list[[8]][5,2]`</span>). 

## Influx Dates

What days saw the highest number of new cases? What days saw the highes number of covid related deaths? What days saw highest number of people fully and partially vaccinated? 

[Coming Soon :D]

# Oregon


```{r, echo=FALSE}
# nightmode theme 
options(reactable.theme = reactableTheme(
  color = "hsl(233, 9%, 87%)",
  backgroundColor = "hsl(233, 9%, 19%)",
  borderColor = "hsl(233, 9%, 22%)",
  stripedColor = "hsl(233, 12%, 22%)",
  highlightColor = "hsl(233, 12%, 24%)",
  inputStyle = list(backgroundColor = "hsl(233, 9%, 25%)"),
  selectStyle = list(backgroundColor = "hsl(233, 9%, 25%)"),
  pageButtonHoverStyle = list(backgroundColor = "hsl(233, 9%, 25%)"),
  pageButtonActiveStyle = list(backgroundColor = "hsl(233, 9%, 28%)")
))
reactable::reactable(or_current %>% 
            # remove date column
            dplyr::select(!Date),
          # modify columns 
          columns = list(Population = colDef(format = colFormat(separators = TRUE)),
                         Cases = colDef(format = colFormat(separators = TRUE)),
                         cases_per_pop = colDef(name = "Percent of Cases", 
                                                format = colFormat(percent = TRUE,
                                                                   digits = 2)),
                         Deaths = colDef(format = colFormat(separators = TRUE)),
                         deaths_per_pop = colDef(name = "Percent of Deaths",
                                                 format = colFormat(percent = TRUE,
                                                                    digits = 2))),
                     defaultSorted = list(Cases = "desc"),
                     bordered = TRUE,
                     highlight = TRUE,
                     showPageSizeOptions = TRUE,
                     pageSizeOptions = c(5, 10, 20, 50),
                     defaultPageSize = 5)
```

## Populated Places

#### What counties in Oreogn have the **most** covid cases? What counties in Oregon have the **most** deaths? 

The county in Oregon that has had the most reported covid cases since `r datas_date` is `r or_list[[1]][1,1]` (<span style="color: turquoise ;">`r or_list[[1]][1,2]`</span>), followed by `r or_list[[1]][2,1]` (<span style="color: turquoise ;">`r or_list[[1]][2,2]`</span>), `r or_list[[1]][3,1]` (<span style="color: turquoise ;">`r or_list[[1]][3,2]`</span>), `r or_list[[1]][4,1]` (<span style="color: turquoise ;">`r or_list[[1]][4,2]`</span>), and then `r or_list[[1]][5,1]` (<span style="color: turquoise ;">`r or_list[[1]][5,2]`</span>).

The county in Oregon with the most reported covid related deaths since `r datas_date` is `r or_list[[3]][1,1]` (<span style="color: turquoise ;">`r or_list[[3]][1,2]`</span>), followed by `r or_list[[3]][2,1]` (<span style="color: turquoise ;">`r or_list[[3]][2,2]`</span>), `r or_list[[3]][3,1]` (<span style="color: turquoise ;">`r or_list[[3]][3,2]`</span>), `r or_list[[3]][4,1]` (<span style="color: turquoise ;">`r or_list[[3]][4,2]`</span>), and then `r or_list[[3]][5,1]` (<span style="color: turquoise ;">`r or_list[[3]][5,2]`</span>). 

## Contageous Spaces

#### What counties in Oregon have the **highest percent** of covid cases?What counties in Oregon have the **highest percent** of covid related deaths? 

As of `r datas_date` `r or_list[[2]][1,1]` county has the highest percent of cases per population with <span style="color: turquoise ;">`r or_list[[2]][1,2]`</span>. Then `r or_list[[2]][2,1]` (<span style="color: turquoise ;">`r or_list[[2]][2,2]`</span>), `r or_list[[2]][3,1]` (<span style="color: turquoise ;">`r or_list[[2]][3,2]`</span>), `r or_list[[2]][4,1]` (<span style="color: turquoise ;">`r or_list[[2]][4,2]`</span>), and `r or_list[[2]][5,1]` (<span style="color: turquoise ;">`r or_list[[2]][5,2]`</span>). 

As of `r datas_date` `r or_list[[4]][1,1]` county has the highest percent of covid related deaths per population with <span style="color: turquoise ;">`r or_list[[4]][1,2]`</span>. Then `r or_list[[4]][2,1]` (<span style="color: turquoise ;">`r or_list[[4]][2,2]`</span>), `r or_list[[4]][3,1]` (<span style="color: turquoise ;">`r or_list[[4]][3,2]`</span>), `r or_list[[4]][4,1]` (<span style="color: turquoise ;">`r or_list[[4]][4,2]`</span>), and `r or_list[[4]][5,1]` (<span style="color: turquoise ;">`r or_list[[4]][5,2]`</span>). 

## Influx Dates

#### What days in Oregon saw the highest number of new cases? What days in Oregon saw the highest number of coivd related deaths? 

[Coming Soon :D]
